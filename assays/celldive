# HuBMAP Cell DIVE Data (GE Research)

## Last Updated: 12/18/2020

This document details Cell DIVE data states, metadata fields, file structure, QA/QC thresholds, and data processing.

## Description: 
Cell DIVE multiplexed imaging is an antibody-based hyperplexed technique for studying spatial cell biology. In brief, the process consists of iterative cycles of staining with fluorescently-labeled antibodies, imaging, and dye inactivation. Automated image processing algorithms for image correction, background fluorescence subtraction, and registration of all multiplexed images allows for expression analysis of more than 60 proteins in a single tissue section at cellular/subcellular levels.

## Definitions: 
There are a variety of terms used in this document that may not be familiar to all HubMap users. The following figures illustrate several of these terms: 

**Figure 1:** *Diagram of microscopy terms. The black box is an example slide or cover slip where the sample is located. Blue boxes are examples of “regions” or user defined imaging areas. For instance, if you want to image a specific structure in the tissue, you would designate a “region” over the structure. Red boxes are examples of “tiles” or the microscope “field of view”. The size of the tile is dependent on the microscope set up and objective. Tiles will fill the region. Because the field of view cannot be changed, tiles will overhang from the region, ensuring the entire region is imaged at the expense of extra tiles being acquired.*

**Figure 2:** *Images are generally acquired with adjacent tiles overlapping, as indicated by the dark regions in the image on the right above. Overlap enhances alignment of tiles for stitching to create a composite image, as shown in Figure 4 below.*

**Figure 3:** * Images of tiles are captured as the stage moves across the imaged region row by row (left) or via a serpentine (or snake-like) path (right).*

**Figure 4:** *Stitching is the process of aligning and merging neighboring image tiles into a single composite image.*

**Figure 5:** *Deep learning based nuclei segmentation*

## Terms defined in this document:
|**Term** |  **Definition**|
|--|--|
|  Intensity| Detector Counts| 
|  Signal| Intensity produced by fluorescence, both endogenous and introduced| 
|  Noise| Intensity not produced by light but electronic fluctuations or electronic background.| 
|  Stitching| Image stitching is the process of combining multiple images (tiles) with overlapping fields of view to produce a single, large image.| 
|  Alignment/Registration| Image registration is the process of transforming different images into one coordinate system. Registration of all channels in each cycle is performed.| 
|  Dedistortion| Dedistortion refers to reversing the optical distortion that takes place in an optical microscope to sharpen images/ improve definition. Practically, a calibration plate with appropriate artifacts is used to determine optical distortion coefficients that are then applied as per the model. |
|  Channels| Name of the fluorescence excitation wavelengths used. May be expressed as a fluorophore name (e.g. DAPI, GFP, DsRED, Cy5), wavelength (e.g. 488, 540, 750)
|  Cycles| A process of adding a round of fluorescently-labeled antibodies, imaging, and dye inactivation.| 
|  Regions| User defined imaging area.| 
|  Cell DIVE| Diversity, Imaging, Variation, Expression  | 
|  Autofluorescence/Background| Endogenous fluorescence signal.| 
|  Fluorescence | Light produced by a fluorophore that is bound to an antibody.|
|  X plane| Plane that determines width| 
|  Y plane| Plane that determines height| 
|  Z plane| Plane that determines depth| 
|  Pixel size| Defines size of pixel on the camera (square)| 
|  Tile| Rectangular field-of-view (Figure 1).| 
|  Field of View| Available imaging area without stage movement. | 
|  Autofluorescence/ Background Subtraction| Subtraction of autofluorescence intensity from total intensity| 

## HuBMAP Cell DIVE Data States (Levels):
The HuBMAP project provides...

|**Data State** |  **Description**| **Example File Type** | 
|--|--|--|
|  0 | Raw image data: This is the data that comes directly off the microscope without preprocessing; sometimes referred to as tiled or unstitched data. (may not always be included).| TIFF|
| 1 |  Processed Microscopy data: Can include stitching, thresholding, background subtraction, de-distortion |  TIFF, OME-TIFF|
| 2 |  Segmentation: Computationally predicted cell (nucleus, cytoplasm) and/or structural boundaries (tubules, ventricles, etc.) |  CSV, TIFF|
| 3 |  Annotation (Cells and Structures): Interpretation of microscopy image and/or segmentation in terms of biology (e.g. unhealthy vs healthy, cell-type, function, functional region). (May not always be included.) |  TIFF, XML|

## HuBMAP Metadata
All HuBMAP Cell DIVE data will have searchable metadata fields.
This metadata field schema resides in Github where it can be viewed and downloaded. Any further changes must now be implemented by filing a [Github](https://github.com/hubmapconsortium/ingest-validation-tools/tree/master/docs/celldive) issue for Chuck McCallum.

## Associated Metadata Content:
The Table below describes the Level 2 metadata fields that are included in the CELLDIVE_metadata_TEMPLATE file.
|**Field** |  **Description**|
|--|--|
|  number of antibodies| total number of antibodies applied to the tissue| 
|  number of channels| Number of imaging channels used| 
|  number of cycles| Number of complete image/stain/image/bleach cycles performed| 
|  number of imaging rounds| Number of separate image rounds conducted| 
|  resolution_x_unit| unit of measure for image resolution about x axis| 
|  resolution_x_value|actual resolution for x axis| 
|  resoltuon_y_unit| unit of measure for image resolution about y axis| 
|  resolution_y_value| actual resolution for y axis| 
|  processing_protcols_io_doi| link to processing protocols|
|  overall_protocols_io_doi| link to overall protocols|

The following metadata fields reside in the appropriate round_info_SXXXXXXXX_RRR.dat, where SXXXXXXXXX is the slide number and RRR refers to the round.  This data is not all included in the CellDIVE_metadata_TEMPLATE and is not intended for inclusion on the web based interface, but since they do appear in the included round_info files we include descriptions here for reference.

